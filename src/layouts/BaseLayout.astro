---
import "../styles/global.css";

const { frontmatter } = Astro.props;
const { title, date } = frontmatter ?? {};

// date は string 前提で正規化
const dateLabel =
  typeof date === "string"
    ? date.slice(0, 10)
    : null;

    console.log(date, dateLabel)

const pageTitle =
  title && dateLabel
    ? `${dateLabel} — ${title}`
    : title ?? "Thinking Lab";

// 現在のURL
const url = Astro.url.pathname;

// 戻り先を自動判定
let backLink = null;

// トップ以外ならトップに戻す
if (url !== "/") {
  backLink = "/";
}
---

<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>{pageTitle}</title>
    <meta name=”description” content=”思考の途中をそのまま置くラボノート。眼鏡っ娘アーキテクチャを軸に、設計・統治・認知・違和感を言葉にする Thinking Lab。” />

    <!-- canonical 自動生成 -->
    <link rel="canonical" href={Astro.url.toString()} />
  </head>

<body>
  <div class="max-w-2xl mx-auto p-4">
    {backLink && (
      <nav class="mb-6">
        <a href={backLink} class="text-sm text-gray-500 hover:text-black">
          ← 戻る
        </a>
      </nav>
    )}

    <main class="prose prose-neutral">
    {title && (<h1 class="mb-4 text-2xl pageTitle">{title}</h1>)}
      <slot />
    </main>
  </div>
</body>
</html>
